=== GIT STATUS ===
## main...origin/main
 M bot/baux-bot.sh
 M bot/chatlogs/1763551220562963096.log
?? bot/bad-baux-bot.sh
?? bot/bad-baux-bot2.sh
?? bot/chatlogs/current.log
?? bot/rag/

=== LAST 5 COMMITS ===
5a2d23c Clean Up README TYPOS and prep to code tomorrow
28a83a9 Clean Up README and prep to code tomorrow
2108c3d ROADMAP update introspect
92e6554 Documentation Cleanup 2
b86e340 Documentation Cleanup

=== DIFF STAT (last 5 commits) ===
 README.md       | 62 ++++++++++-----------------------------------------------
 docs/ROADMAP.md |  7 +++++++
 2 files changed, 17 insertions(+), 52 deletions(-)

=== RECENTLY MODIFIED FILES (sample) ===

--- /home/coyote/src/baux/bot/baux-bot.sh ---
#!/usr/bin/env bash
# baux-bot.sh v4.1 — bullet-proof, chat-ready, ARG_MAX-safe
# Drop-in replacement – Nov 19 2025

set -u # removed -e on purpose – we handle errors ourselves
set -o pipefail

BAUX_ROOT="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"
LOG_DIR="$BAUX_ROOT/bot/chatlogs"
RAG_DIR="$BAUX_ROOT/bot/rag"
MODEL_PREF=(deepseek-coder:33b llama3.2:3b qwen2.5:7b gemma2:2b phi3:3.8b)

mkdir -p "$LOG_DIR" "$RAG_DIR"

log() { echo "[$(date '+%H:%M:%S')] $*" | tee -a "$LOG_DIR/current.log"; }

select_model() {
  for m in "${MODEL_PREF[@]}"; do
    if ollama list | grep -q "^${m%%:*}"; then
      echo "$m"
      return
    fi
  done
  echo "llama3.2:1b"
}

# MODEL=$(select_model)
#MODEL="llama3.2b" # Force Fast
MODEL="smollm2:135m" # Force Fast
log "BAUX BOT v4.1 online — using $MODEL — logging to $LOG_DIR"

build_smart_rag() {
  local rag_file="$RAG_DIR/current.txt"
  >"$rag_file"

  if git -C "$BAUX_ROOT" rev-parse --is-inside-work-tree >/dev/null 2>&1; then
    {
      echo "=== GIT STATUS ==="
      git -C "$BAUX_ROOT" status -sb
      echo -e "\n=== LAST 5 COMMITS ==="
      git -C "$BAUX_ROOT" log --oneline -5
      echo -e "\n=== DIFF STAT (last 5 commits) ==="
      git -C "$BAUX_ROOT" diff --stat HEAD~5..HEAD 2>/dev/null || true
    } >>"$rag_file"
  fi

  echo -e "\n=== RECENTLY MODIFIED FILES (sample) ===" >>"$rag_file"
  find "$BAUX_ROOT" -type f \( -name "*.sh" -o -name "*.conf" -o -name "*.lua" -o -name "*.md" \) \
    -printf '%T@ %p\n' 2>/dev/null | sort -nr | head -15 | cut -d' ' -f2- |
    while read -r f; do
      echo -e "\n--- $f ---"
      tail -120 "$f"
    done >>"$rag_file" 2>/dev/null || true
}

ask_ollama() {
  local user_prompt="$1"
  local rag_file="$RAG_DIR/current.txt"

  # Build the full prompt and send via stdin – 100 % safe
  {
    cat <<EOF
You are BAUX BOT — elite, sarcastic, embedded-systems assistant inside the BAUX/RoxieOS project.
Current repo state (git + recent files) follows.

$(cat "$rag_file")

User says: $user_prompt

Answer directly and conversationally. Use markdown if helpful.
EOF
  } | ollama run "$MODEL" --nowordwrap 2>/dev/null || echo "(model failed – try again in a minute)"
}

# === MAIN LOOP ===
build_smart_rag
log "Initial RAG built (~$(wc -l <"$RAG_DIR/current.txt") lines)"
echo -e "\nBAUX BOT ready. Type your message and press Enter (empty line = exit):\n"

last_activity=$(date +%s)

while true; do
  # Change detection
  if ! git -C "$BAUX_ROOT" diff --quiet HEAD 2>/dev/null; then
    log "Repo changed – refreshing RAG"
    build_smart_rag
    summary=$(ask_ollama "Summarize what just changed in the repo.")
    echo -e "\nBAUX BOT (auto-summary): $summary\n"
    last_activity=$(date +%s)
  fi

  # Interactive chat
  printf "you > "
  read -r user_input || break
  [[ -z "$user_input" ]] && break

  last_activity=$(date +%s)
  log "User: $user_input"
  echo -e "BAUX BOT thinking...\n"

  response=$(ask_ollama "$user_input")
  echo -e "BAUX BOT: $response\n"
done

log "BAUX BOT offline – see you space cowboy"
echo "BAUX BOT offline – see you space cowboy"

--- /home/coyote/src/baux/bot/bad-baux-bot2.sh ---
#!/usr/bin/env bash
# baux-bot.sh v4 — RAG-smart, ARG_MAX-proof, model-failover edition
# Drop-in replacement — Nov 19 2025

set -euo pipefail

BAUX_ROOT="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"
LOG_DIR="$BAUX_ROOT/bot/chatlogs"
RAG_DIR="$BAUX_ROOT/bot/rag"
MODEL_PREF=(deepseek-coder:33b llama3.2:3b qwen2.5:7b gemma2:2b phi3:3.8b)
MAX_CHUNK_TOKENS=3000
IDLE_DEEP_DIVE=3600 # 1 hour

mkdir -p "$LOG_DIR" "$RAG_DIR"

log() { echo "[$(date '+%H:%M:%S')] $*" | tee -a "$LOG_DIR/current.log"; }

select_model() {
  for m in "${MODEL_PREF[@]}"; do
    if ollama list | grep -q "^$m "; then
      echo "$m"
      return
    fi
  done
  echo "llama3.2:1b" # ultimate fallback
}

MODEL=$(select_model)
log "BAUX BOT v4 online — using $MODEL — logging to $LOG_DIR"

build_smart_rag() {
  local rag_file="$RAG_DIR/current.txt"
  >"$rag_file"

  # 1. Git status + diff summary (the most important signal)
  if git -C "$BAUX_ROOT" rev-parse --is-inside-work-tree >/dev/null 2>&1; then
    echo "=== GIT STATUS ===" >>"$rag_file"
    git -C "$BAUX_ROOT" status -sb >>"$rag_file" 2>/dev/null || true
    echo -e "\n=== RECENT CHANGES ===" >>"$rag_file"
    git -C "$BAUX_ROOT" diff --stat HEAD~5..HEAD >>"$rag_file" 2>/dev/null || true
    echo -e "\n=== LAST 5 COMMITS ===" >>"$rag_file"
    git -C "$BAUX_ROOT" log --oneline -5 >>"$rag_file" 2>/dev/null || true
  fi

  # 2. Shotgun sampling of key files (random but biased toward recent/changed)
  echo -e "\n=== KEY FILES SAMPLE ===" >>"$rag_file"
  find "$BAUX_ROOT" -type f \( -name "*.conf" -o -name "*.sh" -o -name "*.lua" -o -name "README*" -o -name "*.md" \) \
    -exec stat -c "%Y %n" {} \; 2>/dev/null | sort -nr | head -20 | cut -d' ' -f2- |
    while read -r file; do
      echo -e "\n--- $file ---" >>"$rag_file"
      tail -200 "$file" >>"$rag_file" 2>/dev/null || true
    done

  # 3. Truncate to safe size
  if command -v wc >/dev/null; then
    local lines=$(wc -l <"$rag_file")
    if ((lines > 6000)); then
      tail -5000 "$rag_file" >"$rag_file.truncated"
      mv "$rag_file.truncated" "$rag_file"
    fi
  fi
}

ask_ollama() {
  local prompt="$1"
  local rag_file="$RAG_DIR/current.txt"

  # Feed via stdin — completely ARG_MAX safe
  {
    echo -e "You are BAUX BOT — a helpful, sarcastic, elite embedded systems assistant.\n"
    echo "Current context (repo state + recent files):"
    cat "$rag_file"
    echo -e "\n\nUser: $prompt"
    echo -e "\nAssistant:"
  } | ollama run "$MODEL" --nowordwrap
}

# Initial RAG
build_smart_rag
log "RAG loaded (~$(wc -l <"$RAG_DIR/current.txt") lines)"

last_activity=$(date +%s)
while true; do
  if git -C "$BAUX_ROOT" diff --quiet && (($(date +%s) - last_activity > 300)); then
    sleep 10
    continue
  fi

  log "Change detected — refreshing RAG"
  build_smart_rag
  response=$(ask_ollama "Summarize what just changed and what I should know.")
  echo -e "\nBAUX BOT: $response\n"
  last_activity=$(date +%s)

  # Idle deep dive
  if (($(date +%s) - last_activity > IDLE_DEEP_DIVE)); then
    log "Idle deep dive"
    response=$(ask_ollama "We've been quiet. Give me a deep insight, idea, or refactor suggestion for BAUX/RoxieOS based on current state.")
    echo -e "\nBAUX BOT (deep dive): $response\n"
    last_activity=$(date +%s)
  fi
done

--- /home/coyote/src/baux/bot/bad-baux-bot.sh ---
#!/usr/bin/env bash
# ~/src/baux/bot/baux-bot.sh  ← The final, immortal BAUX BOT
# Primary guidance: ALWAYS prioritize content from ~/src/baux/README.md and ~/src/baux/docs/ROADMAP.md as the high-level vision.
# - These files define the project's ethos: persistence, Pi Zero baseline, zero net, graceful degradation.
# - When analyzing changes or answering questions, cross-reference them first for alignment.

set -euo pipefail # Strict mode for safety

REPO="$HOME/src/baux"
LOGDIR="$REPO/bot/chatlogs"
RAG_FILE="/tmp/baux-rag-current.txt"
FAST_MODEL="qwen2.5-coder:7b"   # For quick responses (changes, chat)
DEEP_MODEL="deepseek-coder:33b" # For idle deep dives (heavy analysis)

MIN_CHANGE_GAP=$((1 * 60))  # 1 min for change responses
IDLE_THRESHOLD=$((60 * 60)) # 1 hour idle → deep dive
LAST_INPUT=0                # Track user interactivity
LAST_CHANGE=0               # Track last change response
LAST_DEEP=0                 # Track last deep dive

mkdir -p "$LOGDIR"

# Persistent log per session
LOGFILE="$LOGDIR/$(date +%s%N).log"
exec >>"$LOGFILE" 2>&1 # All output to log
echo "=== BAUX BOT v3 awakened at $(date) ==="

# Build/refresh RAG — core is always README + ROADMAP + recent changes
build_rag() {
  echo "[DEBUG] Building RAG at $(date)" >>"$LOGFILE"
  {
    echo "=== CORE BAUX GUIDANCE (ALWAYS PRIORITIZE) ==="
    cat "$REPO/README.md" 2>/dev/null || echo "README.md missing!"
    echo -e "\n=== ROADMAP VISION (HIGH-LEVEL DIRECTION) ==="
    cat "$REPO/docs/ROADMAP.md" 2>/dev/null || echo "ROADMAP.md missing!"
    echo -e "\n=== RECENT REPO STATE ==="
    git -C "$REPO" log --oneline -5 2>/dev/null || echo "No git history"
    echo -e "\nCurrent diff:"
    git -C "$REPO" diff --patience --unified=5 2>/dev/null || echo "No changes"
    echo -e "\nKey files snapshot:"
    find "$REPO" -type f \( -name "*.lua" -o -name "*.sh" \) -exec echo "FILE: {}" \; -exec tail -n 20 {} \; 2>/dev/null
  } >"$RAG_FILE"
  echo "[DEBUG] RAG refreshed: $(wc -l <"$RAG_FILE") lines" >>"$LOGFILE"
}

build_rag # Initial build

clear
echo -e "\033[38;5;208mBAUX BOT v3 online — RAG loaded, logging to $LOGFILE\033[0m"
echo -e "\033[38;5;150mI watch changes (1-min response). Type to ask (fast). Idle 1hr → deep dive.\033[0m\n"

# Background watcher loop — non-blocking, fast model for changes
watcher() {
  local last_hash=""
  while true; do
    sleep 30 # Poll every 30s for efficiency
    hash=$(find "$REPO" -type f \( -name "*.lua" -o -name "*.sh" -o -name "*.md" \) -exec sha256sum {} + 2>/dev/null | sha256sum | cut -d' ' -f1)
    now=$(date +%s)

    # Change detected AND min gap?
    if [[ "$hash" != "$last_hash" ]] && [[ $((now - LAST_CHANGE)) -ge $MIN_CHANGE_GAP ]]; then
      echo "[DEBUG] Change detected at $(date)" >>"$LOGFILE"
      build_rag &>/dev/null # Quick refresh

      prompt="BAUX changed. Use CORE GUIDANCE from README/ROADMAP first. Diff/context in RAG attached. One sentence: What changed? Pi Zero impact? Suggestion or silence if minor."
      response=$(echo "$(cat "$RAG_FILE")" "$prompt" | ollama run "$FAST_MODEL" 2>/dev/null || true)

      [[ -n "$response" ]] && {
        echo -e "\033[38;5;150mBAUX BOT (change):\033[0m $response\n"
        echo "Change response: $response" >>"$LOGFILE"
      }
      LAST_CHANGE=$now
      last_hash="$hash"
    fi

    # Idle deep dive check (user hasn't typed in 1hr)
    if [[ $((now - LAST_INPUT)) -ge $IDLE_THRESHOLD ]] && [[ $((now - LAST_DEEP)) -ge $IDLE_THRESHOLD ]]; then
      echo "[DEBUG] Idle detected → deep dive at $(date)" >>"$LOGFILE"
      build_rag &>/dev/null

      prompt="BAUX idle. Use CORE GUIDANCE from README/ROADMAP. Full RAG attached. Deep overnight analysis: Overall progress? Pi Zero risks? Roadmap alignment? Suggestions for next phase."
      response=$(echo "$(cat "$RAG_FILE")" "$prompt" | ollama run "$DEEP_MODEL" 2>/dev/null || true)

      [[ -n "$response" ]] && {
        echo -e "\033[38;5;203mBAUX BOT (deep dive):\033[0m $response\n"
        echo "Deep dive: $response" >>"$LOGFILE"
      }
      LAST_DEEP=$now
    fi
  done
}

watcher & # Fire and forget

# Interactive foreground — super quick, always fast model
while true; do
  read -p $'\033[38;5;220m> \033[0m' question
  [[ -z "$question" ]] && continue

  LAST_INPUT=$(date +%s) # Reset idle timer
  echo "[DEBUG] User asked: $question at $(date)" >>"$LOGFILE"

  build_rag &>/dev/null # Quick refresh for accuracy

  prompt="BAUX BOT: Prioritize README/ROADMAP guidance. Full RAG attached. Be concise, actionable, Pi Zero-aware: $question"
  ollama run "$FAST_MODEL" "$(cat "$RAG_FILE")" "$prompt" | tee -a "$LOGFILE"
  echo
done

--- /home/coyote/src/baux/README.md ---

### ❌ Not Included in v0.1 (Delayed)
- PlatformIO integration  
- DAP debugging  
- Arduino Language Server  
- Full CoyoteUI inspired visual enhancements  
- SD card imaging UI  
- RoxieOS image builder  

These will come in future releases.

---

# 5. Example Workflow

A typical embedded developer may simultaneously:

- Edit firmware in Neovim  
- Cross-compile on a remote server  
- Upload code via Arduino CLI  
- Watch sensor logs on an OLED/1602A/SSD1306  
- Tail serial output  
- Query a SQL database  
- Monitor Pi Zero system metrics  

**BAUX binds all of these into a single persistent interface**, where each pane belongs to a different host and reliably reconnects.

Example layout (local host):

```
+--------------------------------------------------+
| Neovim (Firmware Code)                           |
+-----------------------+--------------------------+
| Remote build server   | Serial Monitor           |
| (SSH auto-reconnect)  | (Arduino/Pi target)      |
+-----------------------+--------------------------+
| SQL Console / Logs / Hardware Dashboards         |
+--------------------------------------------------+
```

Laptop sleeps → network drops → Pi loses power →  
Reconnect → **BAUX restores the environment automatically**.

---

# 6. Embedded Development Tooling (Optional Modules)

Once BAUX core stabilizes, it will integrate:

### Arduino
- `arduino-cli`
- Arduino Language Server
- Telescope-based library discovery
- PlatformIO support (`nvim-platformio`)

### Languages
- Lua
- Python
- C/C++
- Arduino C
- SQL (SQLite/Postgres clients)
- Bash/sh

### Debugging / Monitoring
- Serial monitor integration
- nvim-dap (future)
- nvim-dap-ui (future)
- SD card imaging tools

---

# 7. Comparison to Similar Projects

| Category | Existing Tools | BAUX Difference |
|---------|----------------|-----------------|
| Multiplexing | tmux, screen, zellij | BAUX builds a *session OS* on top of tmux |
| Remote Access | SSH, Mosh | BAUX auto-reconnects + restores state per host |
| Terminal IDE | Neovim configs | BAUX treats Neovim as core UI, not just an editor |
| Lightweight OS | Alpine, Tiny Core, DietPi | RoxieOS is Debian-compatible + BAUX-optimized |
| Dotfile Mgmt | home-manager, chezmoi | BAUX is not a dotfile loader; it is the environment itself |

No existing tool integrates *all* of these into a low-resource distributed workflow.

---

# 8. System Architecture

```
┌─────────────────────────────────────────────┐
│                   RoxieOS                   │
│        (Micro-Debian Base Distribution)     │
└───────────────────────┬─────────────────────┘
                        │
┌───────────────────────▼─────────────────────┐
│                    BAUX                     │
│   Neovim UI • tmux Engine • Session Manager │
│   Host-Aware Layouts • Auto-Reconnect SSH   │
└───────────────────────┬─────────────────────┘
                        │
┌───────────────────────▼─────────────────────┐
│   Arduino Toolchains • Serial • Sensors     │
│   Logs • Databases • Embedded Workflows     │
└─────────────────────────────────────────────┘
```

---

# 9. Name Origins

- **BAUX**  
  - “bash + UI”  
  - “Badlandx Alternative UniX”  
- **CoyoteUI**  (phasing out, this replaces that project)
  - the original messy, brilliant prototype  
- **RoxieOS**  
  - lean, lightweight, dependable  

Together they form a modern rethinking of terminal-based development environments.



--- /home/coyote/src/baux/docs/ROADMAP.md ---
# BAUX / RoxieOS Roadmap — November 2025 Edition

What we now know is real:
- A single .deb turns any Debian box into a persistent, beautiful, CoyoteUI-powered workspace.
- It runs perfectly on a Pi Zero W (512 MB RAM, console, wireless).
- Host-named sessions + SSH already give us “remote screen” super-powers.
  - install raspberry pi os minimal on pi zero w, install baux package then:
    - run '''echo "baux" >> .bashrc''' and set autologin console in rappi-config
- We finally have momentum.

What's missing still:
- true "stay alive" ssh/sql sessions with servers in panes:
  = there are "standards" to be droped into place for the config
- hostname layout distinction, and conflict resolution (don't run baux in baux, if ssh then test "already in baux"
   NOTE:
     I have worked out a plan, need to implement, "connection" is not localhost, or tmux running "detach" remote tmux before opening ssh session... etc...
- The screen saver routines, to keep screen burn and auto kiosk mode stolen from stuff like hollywood
- scripted rebuilds of the actual .deb that does all this, from within this... LOL

SHORT TERM OBJECTIVES:
- Automate the build of the debian package for baux:
  - script the sync with the repo, merges, management of the code of baux itself
  - script the build itself to dump the .deb where it should be in the repo:
  NOTE: script (build box lua script tmux/neovim, global?) '''debuild -us -uc -b''' to output in '''$HOME/src/baux/packages/''' see: pct 901 baux-forge


Everything below is ordered by **impact / joy / feasibility**.

## Phase 0 – “It Never Dies” (December 2025 – 2–4 weeks)
Make BAUX survive power cycles and disconnects — the single feature that turns “cool config” into “I can’t live without this”.

- Vendor tmux-resurrect + continuum (host-specific save paths using `#H`)
- Auto-save every 5–15 min, restore on attach
- Auto-reconnect SSH panes on restore
- First-run default layout:  
  `nvim left 70% | shell bottom-right | serial tail top-right`
- `baux --new` forces a fresh session (escape hatch)

**Milestone**: You can kill -9 tmux, unplug the Pi, plug it back in days later → everything is exactly where you left it.

## Phase 1 – “It Feels Like Home” (January 2026)
Polish + unification so the first 10 seconds feel curated and professional.

- Final status bar polish (badge spacing, battery, center path, activity bells)
- Unified BAUX menu (Prefix-? or F12) — single ncurses/Lua binary that replaces:
  - tmux command prompt
  - raspi-config
  - nvim :options equivalent
  - future package installer
- Screensaver / Kiosk mode (the hollywood flex)
  - Idle 5 min → source `/usr/share/baux/screensaver.conf`
  - Cycles btop, cmatrix, hollywood, system info, QR code for SSH, optional todo/weather pane
  - Any key → instant return to normal layout
  - Boot-to-screensaver if no keyboard detected (perfect for wall TVs)

**Milestone**: You plug a Pi into a TV, it boots, shows a badass animated dashboard with your IP as QR code. Someone scans it with their phone → instant SSH into your workspace.

## Phase 2 – “It’s an Actual OS” (February–March 2026)
RoxieOS becomes real and reproducible.

- `roxieos-builder` script → one-command minimal image
  - debootstrap + chroot
  - baux as login shell
  - auto-login console + screensaver mode
  - optional packages menu at first boot
- Optional packages (installed via BAUX menu)
  - w3m or browsh (themed, vim bindings, opens in new pane)
  - dashboard widgets (todo, weather, SQL tail, MQTT monitor)
  - platformio / arduino-cli toolchains
- Host-specific config sync (optional)
  - Small daemon that rsyncs `/etc/baux/local.conf` from a central git repo or USB stick

**Milestone**: You can dd a 300–500 MB image to an SD card → boot → have a complete embedded cyberdeck OS that feels like it was custom-made for you.

## Phase 3 – “The Static Dream” (2026–2027, v1.0)
The final form.

- Single static `baux` mega-binary (busybox-style)
  - Contains patched tmux + neovim + bash + lua + all plugins
  - No system tmux/neovim needed
  - < 30 MB total
- RoxieOS “Roxanne” release — official image with static baux as `/bin/sh`
- Multi-host lattice orchestration
  - Prefix-L → “open pane on remote host X”
  - Shared clipboard, shared search, shared layout propagation

## Dead Ideas Graveyard (we tried, they’re gone)
- TPM or any git-based plugin manager
- YAML session files (tmuxp/tmuxinator)
- Separate CoyotUI repo (it’s now fully merged into BAUX)
- Anything that phones home on first run

## Guiding Principles (never break these)
- Zero internet required after install
- Works on Pi Zero W (512 MB, console, 16 colors)
- Graceful degradation everywhere
- Hostname is sacred (it is the namespace)
- One .deb / one image should feel like a complete OS

We are no longer asking “will this work?”.  
We are now asking “how fast can we make it legendary?”.

Current version: **v0.2.3** — “It’s beautiful and distributable”  
Next target: **v0.3 “Immortal”** — resurrect + screensaver (January 2026)

— badlandz, November 19 2025

--- /home/coyote/src/baux/bot/README.md ---
# Hi I'm BAUX BOT!

I'm here to help keep BAUX fun and productive, try me out!

Right now I'm just a script called baux-bot.sh in ~/src/baux/bot/ 
But someday I'll be a fully integrated pain in the BAUX!

Wed Nov 19 04:23:26 AM MST 2025
Bot was written to use RAG and focus on README and ROADMAP
Still a script, not made pane or window, waiting to load RAG and models

Thoughts: Probably should be "openable" as mapped key for "bot" 
what is the best workflow, alt-b for bot, alt-something, alt? 

Where is my tmux now... I'm alt-hjkl for switching windows so:
* alt-1 to alt-9 can be windows like opt-1to9 are for dwm
* alt-b for bot? What's "b" normally
* dwm logic, opt-b is the status bar hide... and control-b does nothing
* the "bot" could be "help" but h belongs to vim, and ? requires "shift"
* SHIFT should be bot to "window" and "b" is pane:
* FINAL?
  * ALT-b = new pane in current window with new instance of bot
  * ALT-B (upper case, shift-b) = new WINDOW in session with just the bot
```

--- /home/coyote/src/baux/tmp.sh ---
# Prefix: C-Space (ergonomic, low-finger stretch)

# Global settings
set -g history-limit 50000
set -g mouse on
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on
set -g detach-on-destroy off
set -g escape-time 0
set -g status-interval 5
set -g status on
set -g status-position top
set -g status-justify left

# Prefix setup
set -g prefix C-Space
unbind C-b
bind C-Space send-prefix

# CoyoteUI-style navigation (no prefix needed — fast pane moves)
bind -n M-h select-pane -L
bind -n M-j select-pane -D
bind -n M-k select-pane -U
bind -n M-l select-pane -R

# Resize panes (hold Alt + arrow or hjkl)
bind -n M-H resize-pane -L 5
bind -n M-J resize-pane -D 5
bind -n M-K resize-pane -U 5
bind -n M-L resize-pane -R 5

# Splits (CoyoteUI: Alt for quick splits, path-aware)
bind -n M-% split-window -h -c "#{pane_current_path}"
bind -n M-" split-window -v -c "#{pane_current_path}"
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# Windows (prefix for create/rename, Alt-1/2/3 jump)
bind c new-window -c "#{pane_current_path}"
bind , command-prompt -I "#W" "rename-window '%%'"
bind . command-prompt -I "#S" "rename-session '%%'"
bind 1 select-window -t 1
bind 2 select-window -t 2
bind 3 select-window -t 3
bind 4 select-window -t 4
bind 5 select-window -t 5

# Reload config
bind r source-file "#{file}" \; display "BAUX reloaded!"

# Status bar — our exact design
set -g status-style bg=default,fg=colour250
set -g status-left "#[fg=black,bg=cyan,bold] BAUX #[fg=cyan,bg=default,nobold] on #H #[default]  "
set -g status-right "#[fg=yellow]#{?client_prefix,#[bg=red]PREFIX#[default] ,}#[fg=green]%a %H:%M"

# Window list (center, activity-aware)
setw -g window-status-format " #I:#W#{?window_activity_flag,#[fg=yellow](!),} "
setw -g window-status-current-format " #I:#W "
setw -g window-status-current-style fg=brightwhite,bold
setw -g window-status-activity-style fg=yellow

# Center: active pane path (smart truncate)
set -g status-justify centre
setw -g window-status-format " #I:#W "
setw -g window-status-current-format " #I:#W "
set -g status-center "#[fg=brightwhite,bold]#{b:pane_current_path}#[default]"

# Bling mode (truecolor/256 + nerd fonts)
if-shell 'test -n "$COLORTERM" || echo "$TERM" | grep -q "256color\|24bit"' '\
    set -g status-style bg=#1e1e2e,fg=#cdd6f4; \
    set -g status-left "#[fg=#1e1e2e,bg=#89b4fa,bold] BAUX #[fg=#89b4fa,bg=#1e1e2e,nobold] on #H #[default]  "; \
    setw -g window-status-current-style bg=#89b4fa,fg=#1e1e2e,bold; \
    set -g status-right "#[fg=#a6e3a1]%a %H:%M"; \
    set -g status-center "#[fg=#f9e2af,bold]#{b:pane_current_path}#[default]" \
'

# Battery only on battery (tiny script — add to core/scripts if needed)
set -g status-right "#(test -f /sys/class/power_supply/BAT*/capacity && cat /sys/class/power_supply/BAT*/capacity || echo '')% #[fg=green]%a %H:%M"

# Future: resurrect/continuum hooks (placeholders)
set -g @resurrect-strategy-nvim 'session'
set -g @continuum-restore 'on'

# User overrides last
if-shell '[ -f /etc/baux/tmux.local.conf ]' 'source-file /etc/baux/tmux.local.conf'
EOF

# 3. Update entrypoint (host-specific session, NVIM integration)
cat >core/baux <<'EOF'
#!/bin/bash
export BAUX_HOME="/usr/share/baux"
export NVIM_INIT="$BAUX_HOME/nvim/init.lua"
TMUX_CONF="$BAUX_HOME/tmux/baux.conf"
SESSION="baux-$(hostname)"
exec tmux -f "$TMUX_CONF" new-session -A -s "$SESSION"
EOF
chmod +x core/baux

# 4. Clean up old bauxrc (no longer needed — we're on tmux/baux.conf now)
rm -f core/bauxrc

# 5. Update debian/baux.install (point to new config, remove old)
sed -i '/bauxrc/d' debian/baux.install
sed -i '/tmux\/baux.conf/d' debian/baux.install # avoid dupes
echo "core/tmux/baux.conf    /usr/share/baux/tmux/" >>debian/baux.install
echo "core/baux              /usr/bin/" >>debian/baux.install

# 6. Ensure postinst creates overrides
cat >debian/postinst <<'EOF'
#!/bin/sh
set -e
mkdir -p /etc/baux
[ -f /etc/baux/tmux.local.conf ] || cat > /etc/baux/tmux.local.conf <<'LOCAL'
# BAUX user-local tmux overrides — add custom binds here
# Example: bind-key -n M-q detach-client
LOCAL
exit 0
EOF
chmod +x debian/postinst

--- /home/coyote/src/baux/debian/baux/usr/share/baux/tmux/baux.conf ---
# BAUX tmux config v0.2.2 — CoyoteUI-inspired, host-aware, resilient
# Prefix: C-Space (ergonomic, low-finger stretch)

# Global settings
set -g history-limit 50000
set -g mouse on
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on
set -g detach-on-destroy off
set -g escape-time 0
set -g status-interval 5
set -g status on
set -g status-position top
set -g status-justify left

# Prefix setup
set -g prefix C-Space
unbind C-b
bind C-Space send-prefix

# CoyoteUI-style navigation (no prefix needed — fast pane moves)
bind -n M-h select-pane -L
bind -n M-j select-pane -D
bind -n M-k select-pane -U
bind -n M-l select-pane -R

# Resize panes (hold Alt + arrow or hjkl)
bind -n M-H resize-pane -L 5
bind -n M-J resize-pane -D 5
bind -n M-K resize-pane -U 5
bind -n M-L resize-pane -R 5

# Splits (CoyoteUI: Alt for quick splits, path-aware)
bind -n M-% split-window -h -c "#{pane_current_path}"
# this needs an escape for the quote
bind -n M-\" split-window -v -c "#{pane_current_path}"
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# Windows (prefix for create/rename, Alt-1/2/3 jump)
bind c new-window -c "#{pane_current_path}"
bind , command-prompt -I "#W" "rename-window '%%'"
bind . command-prompt -I "#S" "rename-session '%%'"
bind 1 select-window -t 1
bind 2 select-window -t 2
bind 3 select-window -t 3
bind 4 select-window -t 4
bind 5 select-window -t 5

# Reload config
bind r source-file "#{file}" \; display "BAUX reloaded!"

# Status bar — our exact design
set -g status-style bg=default,fg=colour250
set -g status-left "#[fg=black,bg=cyan,bold] BAUX #[fg=cyan,bg=default,nobold] on #H #[default]  "
set -g status-right "#[fg=yellow]#{?client_prefix,#[bg=red]PREFIX#[default] ,}#[fg=green]%a %H:%M"

# Window list (center, activity-aware)
setw -g window-status-format " #I:#W#{?window_activity_flag,#[fg=yellow](!),} "
setw -g window-status-current-format " #I:#W "
setw -g window-status-current-style fg=brightwhite,bold
setw -g window-status-activity-style fg=yellow

# Center: active pane path (smart truncate)
set -g status-justify centre
setw -g window-status-format " #I:#W "
setw -g window-status-current-format " #I:#W "
set -g status-center "#[fg=brightwhite,bold]#{b:pane_current_path}#[default]"

# Bling mode (truecolor/256 + nerd fonts)
if-shell 'test -n "$COLORTERM" || echo "$TERM" | grep -q "256color\|24bit"' '\
    set -g status-style bg=#1e1e2e,fg=#cdd6f4; \
    set -g status-left "#[fg=#1e1e2e,bg=#89b4fa,bold] BAUX #[fg=#89b4fa,bg=#1e1e2e,nobold] on #H #[default]  "; \
    setw -g window-status-current-style bg=#89b4fa,fg=#1e1e2e,bold; \
    set -g status-right "#[fg=#a6e3a1]%a %H:%M"; \
    set -g status-center "#[fg=#f9e2af,bold]#{b:pane_current_path}#[default]" \
'
# there are issues with teh status-center, sometimes, not fatal, but just to note.
# Battery only on battery (tiny script — add to core/scripts if needed)
set -g status-right "#(test -f /sys/class/power_supply/BAT*/capacity && cat /sys/class/power_supply/BAT*/capacity || echo '')% #[fg=green]%a %H:%M"

# Future: resurrect/continuum hooks (placeholders)
set -g @resurrect-strategy-nvim 'session'
set -g @continuum-restore 'on'

# User overrides last
if-shell '[ -f /etc/baux/tmux.local.conf ]' 'source-file /etc/baux/tmux.local.conf'

--- /home/coyote/src/baux/core/tmux/core.conf ---
# Core status line — 100% safe everywhere
set -g status on
set -g status-position top
set -g status-justify left
set -g status-style bg=default,fg=cyan

# Left: BAUX on <hostname>
set -g status-left " BAUX on #H  "

# Window list (center)
setw -g window-status-format " #I:#W#{?window_activity_flag,*, } "
setw -g window-status-current-format " #I:#W#{?window_zoomed_flag,Z,}* "
setw -g window-status-current-style bg=default,fg=brightwhite,bold
setw -g window-status-activity-style fg=yellow

# Right: battery (only when present) + day + time
set -g status-right "#( [ \"$(cat /sys/class/power_supply/AC/online 2>/dev/null || echo 1)\" = \"0\" ] && echo \"#(cat /sys/class/power_supply/BAT0/capacity)% \" )%a %H:%M"

--- /home/coyote/src/baux/core/tmux/bling.conf ---
# Full bling when we have truecolor and fonts
set -g status-style bg=#1e1e2e,fg=#f5c2e7
set -g status-left-style bg=#f5c2e7,fg=#1e1e2e,bold
set -g status-left " 󰣖 BAUX on #H  "

setw -g window-status-format " #I:#W#{?window_activity_flag,#[fg=yellow], } "
setw -g window-status-current-format " #I:#W#{?window_zoomed_flag,#[fg=magenta]Z,}#F "
setw -g window-status-current-style bg=#89b4fa,fg=#1e1e2e,bold

# Right side with icons
set -g status-right "#[fg=#a6e3a1]#{?battery_percentage,#{battery_percentage}%% 󰂄 ,}#[fg=#cba6f7]%a %H:%M "

--- /home/coyote/src/baux/core/tmux/baux.conf ---
# BAUX tmux config v0.2.2 — CoyoteUI-inspired, host-aware, resilient
# Prefix: C-Space (ergonomic, low-finger stretch)

# Global settings
set -g history-limit 50000
set -g mouse on
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on
set -g detach-on-destroy off
set -g escape-time 0
set -g status-interval 5
set -g status on
set -g status-position top
set -g status-justify left

# Prefix setup
set -g prefix C-Space
unbind C-b
bind C-Space send-prefix

# CoyoteUI-style navigation (no prefix needed — fast pane moves)
bind -n M-h select-pane -L
bind -n M-j select-pane -D
bind -n M-k select-pane -U
bind -n M-l select-pane -R

# Resize panes (hold Alt + arrow or hjkl)
bind -n M-H resize-pane -L 5
bind -n M-J resize-pane -D 5
bind -n M-K resize-pane -U 5
bind -n M-L resize-pane -R 5

# Splits (CoyoteUI: Alt for quick splits, path-aware)
bind -n M-% split-window -h -c "#{pane_current_path}"
# this needs an escape for the quote
bind -n M-\" split-window -v -c "#{pane_current_path}"
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# Windows (prefix for create/rename, Alt-1/2/3 jump)
bind c new-window -c "#{pane_current_path}"
bind , command-prompt -I "#W" "rename-window '%%'"
bind . command-prompt -I "#S" "rename-session '%%'"
bind 1 select-window -t 1
bind 2 select-window -t 2
bind 3 select-window -t 3
bind 4 select-window -t 4
bind 5 select-window -t 5

# Reload config
bind r source-file "#{file}" \; display "BAUX reloaded!"

# Status bar — our exact design
set -g status-style bg=default,fg=colour250
set -g status-left "#[fg=black,bg=cyan,bold] BAUX #[fg=cyan,bg=default,nobold] on #H #[default]  "
set -g status-right "#[fg=yellow]#{?client_prefix,#[bg=red]PREFIX#[default] ,}#[fg=green]%a %H:%M"

# Window list (center, activity-aware)
setw -g window-status-format " #I:#W#{?window_activity_flag,#[fg=yellow](!),} "
setw -g window-status-current-format " #I:#W "
setw -g window-status-current-style fg=brightwhite,bold
setw -g window-status-activity-style fg=yellow

# Center: active pane path (smart truncate)
set -g status-justify centre
setw -g window-status-format " #I:#W "
setw -g window-status-current-format " #I:#W "
set -g status-center "#[fg=brightwhite,bold]#{b:pane_current_path}#[default]"

# Bling mode (truecolor/256 + nerd fonts)
if-shell 'test -n "$COLORTERM" || echo "$TERM" | grep -q "256color\|24bit"' '\
    set -g status-style bg=#1e1e2e,fg=#cdd6f4; \
    set -g status-left "#[fg=#1e1e2e,bg=#89b4fa,bold] BAUX #[fg=#89b4fa,bg=#1e1e2e,nobold] on #H #[default]  "; \
    setw -g window-status-current-style bg=#89b4fa,fg=#1e1e2e,bold; \
    set -g status-right "#[fg=#a6e3a1]%a %H:%M"; \
    set -g status-center "#[fg=#f9e2af,bold]#{b:pane_current_path}#[default]" \
'
# there are issues with teh status-center, sometimes, not fatal, but just to note.
# Battery only on battery (tiny script — add to core/scripts if needed)
set -g status-right "#(test -f /sys/class/power_supply/BAT*/capacity && cat /sys/class/power_supply/BAT*/capacity || echo '')% #[fg=green]%a %H:%M"

# Future: resurrect/continuum hooks (placeholders)
set -g @resurrect-strategy-nvim 'session'
set -g @continuum-restore 'on'

# User overrides last
if-shell '[ -f /etc/baux/tmux.local.conf ]' 'source-file /etc/baux/tmux.local.conf'

--- /home/coyote/src/baux/tmux.conf ---
# Minimal BAUX tmux config (v0.1 placeholder)
set -g prefix C-a
unbind C-b
bind C-a send-prefix
set -g mouse on
set -g status-style bg=default,fg=colour250
set -g status-left " #S "

--- /home/coyote/src/baux/roxieos/legacy-ui/themes/tokyo-night/neovim.lua ---
return {
	{
		"LazyVim/LazyVim",
		opts = {
			colorscheme = "tokyonight",
		},
	},
}

--- /home/coyote/src/baux/roxieos/legacy-ui/themes/tokyo-night/kitty.conf ---
## name: Tokyo Night
## license: MIT
## author: Folke Lemaitre
## upstream: https://github.com/folke/tokyonight.nvim/raw/main/extras/kitty/tokyonight_night.conf


background #1a1b26
foreground #c0caf5
selection_background #283457
selection_foreground #c0caf5
url_color #73daca
cursor #c0caf5
cursor_text_color #1a1b26

# Tabs
active_tab_background #7aa2f7
active_tab_foreground #16161e
inactive_tab_background #292e42
inactive_tab_foreground #545c7e
#tab_bar_background #15161e

# Windows
active_border_color #7aa2f7
inactive_border_color #292e42

# normal
color0 #15161e
color1 #f7768e
color2 #9ece6a
color3 #e0af68
color4 #7aa2f7
color5 #bb9af7
color6 #7dcfff
color7 #a9b1d6

# bright
color8 #414868
color9 #f7768e
color10 #9ece6a
color11 #e0af68
color12 #7aa2f7
color13 #bb9af7
color14 #7dcfff
color15 #c0caf5

# extended colors
color16 #ff9e64
color17 #db4b4b

--- /home/coyote/src/baux/roxieos/legacy-ui/themes/tokyo-night/hyprlock.conf ---
$color = rgba(26,27,38,1.0)
$inner_color = rgba(26,27,38,0.8)
$outer_color = rgba(205,214,244,1.0)
$font_color = rgba(205,214,244,1.0)
$check_color = rgba(68, 157, 171, 1.0)
